!function(e){var t={};MediumEditor&&"function"==typeof MediumEditor&&(MediumEditor.prototype.serialize=function(){var t,n,i,s,r,a,o,m,d={};for(t=0;t<this.elements.length;t+=1){for(i=""!==this.elements[t].id?this.elements[t].id:"element-"+t,s=e(this.elements[t]).clone(),r=e(".mediumInsert",s),n=0;n<r.length;n++)a=e(r[n]),o=e(".mediumInsert-placeholder",a).children(),0===o.length?a.remove():(a.removeAttr("contenteditable"),e("img[draggable]",a).removeAttr("draggable"),a.hasClass("small")&&o.addClass("small"),e(".mediumInsert-buttons",a).remove(),o.unwrap());m=s.html().trim(),d[i]={value:m}}return d},MediumEditor.prototype.deactivate=function(){var t;if(!this.isActive)return!1;for(this.isActive=!1,void 0!==this.toolbar&&(this.toolbar.style.display="none"),document.documentElement.removeEventListener("mouseup",this.checkSelectionWrapper),t=0;t<this.elements.length;t+=1)this.elements[t].removeEventListener("keyup",this.checkSelectionWrapper),this.elements[t].removeEventListener("blur",this.checkSelectionWrapper),this.elements[t].removeAttribute("contentEditable");e.fn.mediumInsert.insert.$el.mediumInsert("disable")},MediumEditor.prototype.activate=function(){var t;if(this.isActive)return!1;for(void 0!==this.toolbar&&(this.toolbar.style.display="block"),this.isActive=!0,t=0;t<this.elements.length;t+=1)this.elements[t].setAttribute("contentEditable",!0);this.bindSelect(),e.fn.mediumInsert.insert.$el.mediumInsert("enable")}),e.fn.mediumInsert=function(n){return"string"==typeof n&&e.fn.mediumInsert.insert[n]?void e.fn.mediumInsert.insert[n]():(e.fn.mediumInsert.settings=e.extend(e.fn.mediumInsert.settings,n),this.each(function(){e(this).addClass("medium-editor-insert-plugin");var n="p, h1, h2, h3, h4, h5, h6, ol, ul, blockquote";e(this).on("dragover drop",n,function(e){return e.preventDefault(),!1}),e.fn.mediumInsert.insert.init(e(this)),e.each(e.fn.mediumInsert.settings.addons,function(n){var i=e.fn.mediumInsert.settings.addons[n];i.$el=e.fn.mediumInsert.insert.$el,t[n].init(i)})}))},e.fn.mediumInsert.settings={enabled:!0,beginning:!1,addons:{images:{},embeds:{}}},e.fn.mediumInsert.registerAddon=function(e,n){t[e]=n},e.fn.mediumInsert.getAddon=function(e){return t[e]},e.fn.mediumInsert.insert={init:function(e){this.$el=e,this.isFirefox=navigator.userAgent.match(/firefox/i),this.setPlaceholders(),this.setEvents()},deselect:function(){document.getSelection().removeAllRanges()},disable:function(){e.fn.mediumInsert.settings.enabled=!1,e.fn.mediumInsert.insert.$el.find(".mediumInsert-buttons").addClass("hide")},enable:function(){e.fn.mediumInsert.settings.enabled=!0,e.fn.mediumInsert.insert.$el.find(".mediumInsert-buttons").removeClass("hide")},getMaxId:function(){var t=-1;return e('div[id^="mediumInsert-"]').each(function(){var n=parseInt(e(this).attr("id").split("-")[1],10);n>t&&(t=n)}),t},getButtons:function(n){var i=e.fn.mediumInsert.settings.editor,s=i&&i.options?i.options.buttonLabels:"",r='<div class="mediumInsert-buttons"><a class="mediumInsert-buttonsShow">+</a><ul class="mediumInsert-buttonsOptions medium-editor-toolbar medium-editor-toolbar-active">';return 0===Object.keys(e.fn.mediumInsert.settings.addons).length?!1:("undefined"==typeof n?e.each(e.fn.mediumInsert.settings.addons,function(e){r+="<li>"+t[e].insertButton(s)+"</li>"}):r+="<li>"+t[n].insertButton(s)+"</li>",r+="</ul></div>")},setPlaceholders:function(){var t,n=this,i=e.fn.mediumInsert.insert.$el,s=e.fn.mediumInsert.settings.editor,r=(s&&s.options?s.options.buttonLabels:"",this.getButtons());return r===!1?!1:(r='<div class="mediumInsert" contenteditable="false">'+r+'<div class="mediumInsert-placeholder"></div></div>',i.is(":empty")&&i.html("<p><br></p>"),void i.keyup(function(){var s,a=i.children(":last");(""===i.html()||"<br>"===i.html())&&i.html("<p><br></p>"),a.hasClass("mediumInsert")&&a.find(".mediumInsert-placeholder").children().length>0&&i.append("<p><br></p>"),this.isFirefox&&e(".mediumInsert .mediumInsert-placeholder:empty",i).each(function(){e(this).parent().remove()}),s=n.getMaxId()+1;var o="p, h1, h2, h3, h4, h5, h6, ol, ul, blockquote";e.fn.mediumInsert.settings.beginning&&(t=i.children(o).first(),t.prev().hasClass("mediumInsert")===!1&&(t.before(r),t.prev(".mediumInsert").attr("id","mediumInsert-"+s).addClass("mediumInsert-first"),s++)),i.children(o).each(function(){e(this).next().hasClass("mediumInsert")===!1&&(e(this).after(r),e(this).next(".mediumInsert").attr("id","mediumInsert-"+s)),s++})}).keyup())},setEvents:function(){var n=this,i=e.fn.mediumInsert.insert.$el;i.on("selectstart",".mediumInsert",function(e){return e.preventDefault(),!1}),i.on("blur",function(){var t,n=e(this).clone();n.find(".mediumInsert").remove(),t=n.html().replace(/^\s+|\s+$/g,""),(""===t||"<p><br></p>"===t)&&e(this).addClass("medium-editor-placeholder")}),i.on("keypress",function(e){if(n.isFirefox&&13===e.keyCode){i.contents().each(function(){return function(e,t){return"#text"===t.nodeName?(document.execCommand("insertHTML",!1,"<p>"+t.data+"</p>"),t.remove()):void 0}}(this));var t=i.find("p").last();t.text().length>0&&t.find("br").remove()}}),i.on("keydown",function(e){return navigator.userAgent.match(/chrome/i)&&(i.children().last().removeClass("hide"),(e.ctrlKey||e.metaKey)&&65===e.which)?(e.preventDefault(),0===i.find("p").text().trim().length?!1:(i.children().last().addClass("hide"),document.execCommand("selectAll",!1,null))):void 0}),i.on("click",".mediumInsert-buttons a.mediumInsert-buttonsShow",function(){var t=e(this).siblings(".mediumInsert-buttonsOptions"),i=e(this).parent().siblings(".mediumInsert-placeholder");e(this).hasClass("active")?(e(this).removeClass("active"),t.hide(),e("a",t).show()):(e(this).addClass("active"),t.show(),e("a",t).each(function(){var n=e(this).attr("class").split("action-")[1],s=n.split("-")[0];e(".mediumInsert-"+s,i).length>0&&e("a:not(.action-"+n+")",t).hide()})),n.deselect()}),i.on("mouseleave",".mediumInsert",function(){e("a.mediumInsert-buttonsShow",this).removeClass("active"),e(".mediumInsert-buttonsOptions",this).hide()}),i.on("click",".mediumInsert-buttons .mediumInsert-action",function(n){n.preventDefault();var i=e(this).data("addon"),s=e(this).data("action"),r=e(this).parents(".mediumInsert-buttons").siblings(".mediumInsert-placeholder");t[i]&&t[i][s]&&t[i][s](r),e(this).parents(".mediumInsert").mouseleave()})}}}(jQuery),function(e){e.fn.mediumInsert.registerAddon("embeds",{"default":{urlPlaceholder:"Paste or type a link"},init:function(t){this.options=e.extend(this.default,t),this.$el=e.fn.mediumInsert.insert.$el,this.setEmbedButtonEvents(),this.preparePreviousEmbeds()},insertButton:function(e){var t="Embed";return("fontawesome"==e||"object"==typeof e&&e.fontawesome)&&(t='<i class="fa fa-code"></i>'),'<button data-addon="embeds" data-action="add" class="medium-editor-action mediumInsert-action">'+t+"</button>"},add:function(t){e.fn.mediumInsert.insert.deselect();var n='<div class="medium-editor-toolbar medium-editor-toolbar-active medium-editor-toolbar-form-anchor mediumInsert-embedsWire" style="display: block;"><input type="text" value="" placeholder="'+this.options.urlPlaceholder+'" class="mediumInsert-embedsText"></div>';e(n).appendTo(t.prev()),setTimeout(function(){t.prev().find("input").focus()},50),e.fn.mediumInsert.insert.deselect(),this.currentPlaceholder=t,e(".mediumInsert-embedsText").focus()},preparePreviousEmbeds:function(){this.$el.find(".mediumInsert-embeds").each(function(){var t=e(this).parent();t.html('<div class="mediumInsert-placeholder" draggable="true">'+t.html()+"</div>")})},setEmbedButtonEvents:function(){var t=this;e(document).on("keypress","input.mediumInsert-embedsText",function(e){(e.which&&13==e.which||e.keyCode&&13==e.keyCode)&&(t.setEnterActionEvents(),t.removeToolbar())}),this.$el.on("blur",".mediumInsert-embedsText",function(){t.removeToolbar()})},setEnterActionEvents:function(){function t(t){if(!t)return alert("Incorrect URL format specified"),!1;var i=t,s=(new Date).getTime();t=e('<div class="mediumInsert-embeds" id="'+s+'"></div>').append(t),n.currentPlaceholder.append(t),n.currentPlaceholder.closest("[data-medium-element]").trigger("keyup").trigger("input"),-1!=i.indexOf("facebook")&&"undefined"!=typeof FB&&setTimeout(function(){FB.XFBML.parse()},2e3)}var n=this;if(e.fn.mediumInsert.settings.enabled===!1)return!1;var i=e("input.mediumInsert-embedsText").val();if(!i)return!1;if(!this.options.oembedProxy){var s=n.convertUrlToEmbedTag(i);return t(s)}n.getOEmbedHTML(i,function(e,n){var i=!e&&n&&n.html;n&&!n.html&&"photo"===n.type&&n.url&&(i='<img src="'+n.url+'" />'),t(i)})},removeToolbar:function(){e(".mediumInsert-embedsWire").remove()},getOEmbedHTML:function(t,n){e.ajax({url:this.options.oembedProxy,dataType:"json",data:{url:t},success:function(e,t,i){n(null,e,i)},error:function(e,t,i){var s=function(){try{return JSON.parse(e.responseText)}catch(t){}}();n(s&&s.error||e.status||i.message,s,e)}})},convertUrlToEmbedTag:function(e){if(!new RegExp(["youtube","yout.be","vimeo","facebook","instagram"].join("|")).test(e))return!1;var t=e.replace(/\n?/g,"").replace(/^((http(s)?:\/\/)?(www\.)?(youtube\.com|youtu\.be)\/(watch\?v=|v\/)?)([a-zA-Z0-9-_]+)(.*)?$/,'<div class="video"><iframe width="420" height="315" src="//www.youtube.com/embed/$7" frameborder="0" allowfullscreen></iframe></div>').replace(/^http:\/\/vimeo\.com(\/.+)?\/([0-9]+)$/,'<iframe src="//player.vimeo.com/video/$2" width="500" height="281" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>').replace(/^https:\/\/www\.facebook\.com\/(video.php|photo.php)\?v=(\d+).+$/,'<div class="fb-post" data-href="https://www.facebook.com/photo.php?v=$2"><div class="fb-xfbml-parse-ignore"><a href="https://www.facebook.com/photo.php?v=$2">Post</a></div></div>').replace(/^http:\/\/instagram\.com\/p\/(.+)\/?$/,'<span class="instagram"><iframe src="//instagram.com/p/$1/embed/" width="612" height="710" frameborder="0" scrolling="no" allowtransparency="true"></iframe></span>');return/<("[^"]*"|'[^']*'|[^'">])*>/.test(t)?t:!1}})}(jQuery),function(e){e.fn.mediumInsert.registerAddon("images",{"default":{useDragAndDrop:!0,imagesUploadScript:"upload.php",imagesDeleteScript:"delete.php",formatData:function(e){var t=new FormData;return t.append("file",e),t},uploadFile:function(t,n,i){e.ajax({type:"post",url:i.options.imagesUploadScript,xhr:function(){var e=new XMLHttpRequest;return e.upload.onprogress=i.updateProgressBar,e},cache:!1,contentType:!1,complete:function(e){i.uploadCompleted(e,t)},processData:!1,data:i.options.formatData(n)})},deleteFile:function(t,n){e.ajax({type:"post",url:n.options.imagesDeleteScript,data:{file:t}})}},init:function(t){t&&t.$el&&(this.$el=t.$el),this.options=e.extend(this.default,t),this.setImageEvents(),this.options.useDragAndDrop===!0&&this.setDragAndDropEvents(),this.preparePreviousImages()},insertButton:function(e){var t="Img";return("fontawesome"==e||"object"==typeof e&&e.fontawesome)&&(t='<i class="fa fa-picture-o"></i>'),'<button data-addon="images" data-action="add" class="medium-editor-action mediumInsert-action">'+t+"</button>"},preparePreviousImages:function(){this.$el.find(".mediumInsert-images").each(function(){var t=e(this).parent();t.html(e.fn.mediumInsert.insert.getButtons("images")+'<div class="mediumInsert-placeholder" draggable="true">'+t.html()+"</div>")})},add:function(t){var n,i,s=this;return n=e('<input type="file">').click(),n.change(function(){i=this.files,s.uploadFiles(t,i,s)}),e.fn.mediumInsert.insert.deselect(),n},updateProgressBar:function(t){var n,i=e(".progress:first",this.$el);t.lengthComputable&&(n=t.loaded/t.total*100,n=n?n:0,i.attr("value",n),i.html(n))},uploadCompleted:function(t,n){var i,s=e(".progress:first",n);s.attr("value",100),s.html(100),t.responseText?(s.before('<figure class="mediumInsert-images"><img src="'+t.responseText+'" draggable="true" alt=""></figure>'),i=s.siblings("img"),i.load(function(){i.parent().mouseleave().mouseenter()})):(s.before('<div class="mediumInsert-error">There was a problem uploading the file.</div>'),setTimeout(function(){e(".mediumInsert-error:first",n).fadeOut(function(){e(this).remove()})},3e3)),s.remove(),n.closest("[data-medium-element]").trigger("keyup").trigger("input")},uploadFile:function(e,t,n){return n.options.uploadFile(e,t,n)},uploadFiles:function(e,t,n){for(var i={"image/png":!0,"image/jpeg":!0,"image/gif":!0},s=0;s<t.length;s++){var r=t[s];i[r.type]===!0&&(e.append('<progress class="progress" min="0" max="100" value="0">0</progress>'),n.uploadFile(e,r,n))}},deleteFile:function(e,t){return t.options.deleteFile(e,t)},setImageEvents:function(){var t=this;this.$el.on("mouseenter",".mediumInsert-images",function(){var t,n,i=e("img",this);e.fn.mediumInsert.settings.enabled!==!1&&i.length>0&&(e(this).append('<a class="mediumInsert-imageRemove"></a>'),e(this).append(e(this).parent().parent().hasClass("small")?'<a class="mediumInsert-imageResizeBigger"></a>':'<a class="mediumInsert-imageResizeSmaller"></a>'),t=i.position().top+parseInt(i.css("margin-top"),10),n=i.position().left+i.width()-30,e(".mediumInsert-imageRemove",this).css({right:"auto",top:t,left:n}),e(".mediumInsert-imageResizeBigger, .mediumInsert-imageResizeSmaller",this).css({right:"auto",top:t,left:n-31}))}),this.$el.on("mouseleave",".mediumInsert-images",function(){e(".mediumInsert-imageRemove, .mediumInsert-imageResizeSmaller, .mediumInsert-imageResizeBigger",this).remove()}),this.$el.on("click",".mediumInsert-imageResizeSmaller",function(){e(this).parent().parent().parent().addClass("small"),e(this).parent().mouseleave().mouseleave(),e.fn.mediumInsert.insert.deselect(),t.$el.closest("[data-medium-element]").trigger("keyup").trigger("input")}),this.$el.on("click",".mediumInsert-imageResizeBigger",function(){e(this).parent().parent().parent().removeClass("small"),e(this).parent().mouseleave().mouseleave(),e.fn.mediumInsert.insert.deselect(),t.$el.closest("[data-medium-element]").trigger("keyup").trigger("input")}),this.$el.on("click",".mediumInsert-imageRemove",function(){var n=e(this).siblings("img").attr("src");0===e(this).parent().siblings().length&&e(this).parent().parent().parent().removeClass("small"),e(this).parent().remove(),t.deleteFile(n,t),e.fn.mediumInsert.insert.deselect(),t.$el.closest("[data-medium-element]").trigger("keyup").trigger("input")})},setDragAndDropEvents:function(){var t,n,i=this,s=!1,r=!1;e(document).on("dragover","body",function(){e.fn.mediumInsert.settings.enabled!==!1&&i.$el.addClass("hover")}),e(document).on("dragend","body",function(){e.fn.mediumInsert.settings.enabled!==!1&&i.$el.removeClass("hover")}),this.$el.on("dragover",".mediumInsert",function(){e.fn.mediumInsert.settings.enabled!==!1&&(e(this).addClass("hover"),e(this).attr("contenteditable",!0))}),this.$el.on("dragleave",".mediumInsert",function(){e.fn.mediumInsert.settings.enabled!==!1&&(e(this).removeClass("hover"),e(this).attr("contenteditable",!1))}),this.$el.on("dragstart",".mediumInsert .mediumInsert-images img",function(){e.fn.mediumInsert.settings.enabled!==!1&&(t=e(this).parent().index(),n=e(this).parent().parent().parent().attr("id"))}),this.$el.on("dragend",".mediumInsert .mediumInsert-images img",function(t){e.fn.mediumInsert.settings.enabled!==!1&&s===!0&&(0===e(t.originalEvent.target.parentNode).siblings().length&&e(t.originalEvent.target.parentNode).parent().parent().removeClass("small"),e(t.originalEvent.target.parentNode).mouseleave(),e(t.originalEvent.target.parentNode).remove(),s=!1,r=!1,i.$el.closest("[data-medium-element]").trigger("keyup").trigger("input"))}),this.$el.on("dragover",".mediumInsert .mediumInsert-images img",function(t){e.fn.mediumInsert.settings.enabled!==!1&&t.preventDefault()}),this.$el.on("drop",".mediumInsert .mediumInsert-images img",function(){var s,a,o;if(e.fn.mediumInsert.settings.enabled!==!1){if(n!==e(this).parent().parent().parent().attr("id"))return r=!1,void(t=n=null);s=parseInt(t,10),a=e(this).parent().parent().find(".mediumInsert-images:nth-child("+(s+1)+")"),o=e(this).parent().index(),o>s?a.insertAfter(e(this).parent()):s>o&&a.insertBefore(e(this).parent()),a.mouseleave(),r=!0,t=null,i.$el.closest("[data-medium-element]").trigger("keyup").trigger("input")}}),this.$el.on("drop",".mediumInsert",function(t){var n;t.preventDefault(),e.fn.mediumInsert.settings.enabled!==!1&&(e(this).removeClass("hover"),i.$el.removeClass("hover"),e(this).attr("contenteditable",!1),n=t.originalEvent.dataTransfer.files,n.length>0?i.uploadFiles(e(".mediumInsert-placeholder",this),n,i):r===!0?r=!1:(e(".mediumInsert-placeholder",this).append('<figure class="mediumInsert-images">'+t.originalEvent.dataTransfer.getData("text/html")+"</figure>"),e("meta",this).remove(),s=!0))})}})}(jQuery),function(e){e.fn.mediumInsert.registerAddon("maps",{init:function(){this.$el=e.fn.mediumInsert.insert.$el},insertButton:function(e){var t="Map";return("fontawesome"==e||"object"==typeof e&&e.fontawesome)&&(t='<i class="fa fa-map-marker"></i>'),'<button data-addon="maps" data-action="add" class="medium-editor-action mediumInsert-action">'+t+"</button>"},add:function(t){e.fn.mediumInsert.insert.deselect(),t.append('<div class="mediumInsert-maps">Map - Coming soon...</div>')}})}(jQuery),function(e){e.fn.mediumInsert.registerAddon("tables",{"default":{defaultRows:2,defaultCols:2},init:function(t){this.options=e.extend(this.default,t),this.$el=e.fn.mediumInsert.insert.$el,this.setTableButtonEvents()},insertButton:function(e){var t="Table";return("fontawesome"==e||"object"==typeof e&&e.fontawesome)&&(t='<i class="fa fa-table"></i>'),'<button data-addon="tables" data-action="add" class="medium-editor-action mediumInsert-action">'+t+"</button>"},add:function(t){e.fn.mediumInsert.insert.deselect();var n='<div class="medium-editor-toolbar-form-anchor mediumInsert-tableDemoBox"><table><tr><td></td><td><label>cols:<input type="text" value="'+this.options.defaultCols+'" class="mediumInsert-tableCols" /></label></td></tr><tr><td><label>rows:<input type="text" value="'+this.options.defaultRows+'" class="mediumInsert-tableRows" /></label></td><td><table class="mediumInsert-demoTable"></table></td></tr><tr><td></td><td><label><button class="mediumInsert-tableReadyButton">insert</button></label></td></tr></table></</div>';e(n).appendTo(t.prev()),this.updateDemoTable(),setTimeout(function(){t.prev().find("input").focus()},50),e.fn.mediumInsert.insert.deselect(),this.currentPlaceholder=t},setTableButtonEvents:function(){var t=this;e(document).on("keyup","input.mediumInsert-tableRows, input.mediumInsert-tableCols",function(){t.updateDemoTable()}),e(document).on("click",function(n){0===e(n.target).parents(".mediumInsert-buttons").length&&t.removeToolbar()}),e(document).on("click","button.mediumInsert-tableReadyButton",function(){t.setEnterActionEvents(),t.removeToolbar()})},getDimensions:function(){return{rows:parseFloat(e("input.mediumInsert-tableRows").val())||1,cols:parseFloat(e("input.mediumInsert-tableCols").val())||1}},buildTable:function(t){var n,i,s,r=this.getDimensions(),a=e(t);for(n=0;n<r.rows;n++){for(s=e("<tr>"),i=0;i<r.cols;i++)s.append("<td>");a.append(s)}},updateDemoTable:function(){var t=e("table.mediumInsert-demoTable");t.empty(),this.buildTable(t)},setEnterActionEvents:function(){var t=this;if(e.fn.mediumInsert.settings.enabled===!1)return!1;var n=e('<table class="mediumInsert-table">');t.buildTable(n),t.currentPlaceholder.append(n),t.currentPlaceholder.closest("[data-medium-element]").trigger("keyup").trigger("input")},removeToolbar:function(){e(".mediumInsert-tableDemoBox").remove()}})}(jQuery);